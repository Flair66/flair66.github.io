<!doctype html>
<html lang="de">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<title>Gin-Karte</title>

		<style>
			table.table>thead>tr>th {
				vertical-align: middle;
				text-align: center;
				white-space: nowrap;
			}
			table.table>tbody>tr>td {
				white-space: nowrap;
				padding-left: .5rem;
				padding-right: .5rem;
			}
			td>svg {
				color: rgb(231, 196, 0);
			}
		</style>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
	</head>
	<body class="bg-light container-xl">
		<h1 class="my-3">
			Gin-Karte
		</h1>
		<div class="table-responsive-sm">
			<table class="table table-sm table-hover bg-white border border-lg">
				<thead>
					<tr>
						<th rowspan="2" scope="col"></th>
						<th rowspan="2" scope="col" style="width: 50%;">Name</th>
						<th rowspan="2" scope="col">Art</th>
						<th rowspan="2" scope="col">Herkunft</th>
						<th rowspan="2" scope="col">VOL</th>
						<th colspan="6" scope="colgroup">Geschmack</th>
						<th rowspan="2" scope="col">Preis</th>
					</tr>
					<tr>
						<th scope="col">Wacholder</th>
						<th scope="col">Citrus</th>
						<th scope="col">Fruchtig</th>
						<th scope="col">Blumig</th>
						<th scope="col">Kr√§uter</th>
						<th scope="col">Scharf</th>
					</tr>
				</thead>
				<tbody id="data"></tbody>
			</table>
		</div>

		<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
		<script>
			const STAR = [
				`<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-star" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path fill-rule="evenodd" d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.523-3.356c.329-.314.158-.888-.283-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767l-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288l1.847-3.658 1.846 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.564.564 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z"/>
				</svg>`,
				`<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-star-half" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path fill-rule="evenodd" d="M5.354 5.119L7.538.792A.516.516 0 0 1 8 .5c.183 0 .366.097.465.292l2.184 4.327 4.898.696A.537.537 0 0 1 16 6.32a.55.55 0 0 1-.17.445l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256a.519.519 0 0 1-.146.05c-.341.06-.668-.254-.6-.642l.83-4.73L.173 6.765a.55.55 0 0 1-.171-.403.59.59 0 0 1 .084-.302.513.513 0 0 1 .37-.245l4.898-.696zM8 12.027c.08 0 .16.018.232.056l3.686 1.894-.694-3.957a.564.564 0 0 1 .163-.505l2.906-2.77-4.052-.576a.525.525 0 0 1-.393-.288L8.002 2.223 8 2.226v9.8z"/>
				</svg>`,
				`<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-star-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.283.95l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
				</svg>`
			];
			function getStarHTML(value, reference_value) {
				if (value < reference_value) {
					return STAR[0];
				} else if (value === reference_value) {
					return STAR[1];
				} else {
					return STAR[2];
				}
			}

			function getStarsHTML(value) {
				if (value < 0) {
					return `<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-dash text-muted" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
								<path fill-rule="evenodd" d="M3.5 8a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.5-.5z"/>
							</svg>`;
				} else {
					return getStarHTML(value, 1)
							+ getStarHTML(value, 3)
							+ getStarHTML(value, 5)
							+ getStarHTML(value, 7)
							+ getStarHTML(value, 9);
				}
			}

			function addElement(element) {
				document.getElementById('data').insertAdjacentHTML('beforeend', `
					<tr>
						<td>
							<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle text-dark" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
								<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"></path>
								<path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588z"></path>
								<circle cx="8" cy="4.5" r="1"></circle>
							</svg>
						</td>
						<td>${element.name}</td>
						<td>${element.type}</td>
						<td>${element.origin}</td>
						<td style="text-align: right">${element.vol}</td>
						<td style="text-align: center">${getStarsHTML(element.taste.juniper)}</td>
						<td style="text-align: center">${getStarsHTML(element.taste.citrus)}</td>
						<td style="text-align: center">${getStarsHTML(element.taste.fruit)}</td>
						<td style="text-align: center">${getStarsHTML(element.taste.floral)}</td>
						<td style="text-align: center">${getStarsHTML(element.taste.herbal)}</td>
						<td style="text-align: center">${getStarsHTML(element.taste.spice)}</td>
						<td style="text-align: right">${element.price}</td>
					</tr>
				`);
			}

			async function run() {
				let raw_data = await fetch("./gin.data.json");
				let data = await raw_data.json();
				data.elements.sort((a, b) => {
					const aname = a.name.toLowerCase();
					const bname = b.name.toLowerCase();

					if (aname > bname) {
						return 1;
					} else if (aname < bname) {
						return -1;
					} else {
						return 0;
					}
				}).forEach(element => {
					addElement(element);
				});
			}
			run();
		</script>
	</body>
</html>
